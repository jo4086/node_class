# Node.js에서 스레드와 이벤트 루프의 관게

### 1. Node.js는 싱글 스레드 동작

-  작업 순서를 주는것 = 싱글 스레드의 역할

-  JavaScript코드는 메인 이벤트 루프 스레드에서 실행

-  백그라운드 스레드는 libuv(Node.js C++ 라이브러리)에 의해 제공
   -  실행 목록
      <ol type="A">
       <li> 파일 시스템 I/O</li>
       <li> 네트워크 작업</li>
       <li> 타이머 같은 비동기 작업</li>
   </ol>

<hr>

### 2. Microtask Queue, Timers Queue, Check Queue의 역할

이 대기열은 작업의 **[우선순위 and 실행 시점]** 을 결정하는 이벤트 구성 요소

스레드가 아니라 작업 대기열로 백그라운드 스레드는 `libuv`에 의해 관리, 이벤트 루프와 별개로 비공기 작업을 처리

1. **Microtask Queue**

   -  **우선 순위** : $\textsf{\color{red}{1순위}}$
   -  **작업 종류**
      -  process.nextTick()
      -  Promise의 .then(), .catch(), .finally()
   -  **특징**
      -  현재 실행 中 작업이 끝나기 전에 실행
      -  이벤트 루프의 다른 단계보다 가장 먼저 처리
      ***

2. **Timers Queue**

   -  우선 순위 : 2순위
   -  작업 종류
      -  setTimeout(callback, delay)
      -  setInterval(callback, interval)
   -  특징
      -  Microtask Queue가 빈 상태 $\color{magenta}{AND}$ 이벤트 루프가 Timers 단계에 도달할 때 실행

3. **Check Queue**

   -  우선 순위 : 3순위
   -  작업 종류
      -  setImmediate(callback)
   -  특징

      -  Timer Queue 작업이 완료된 이후에 실행

---

### 3. Node.js의 백그라운드에서 기본 스레드

Node.js는 **이벤트 루프** 외에 libuv 라이브러리를 통해 기본적으로 백그라운드 스레드 풀 제공

기본 4개의 스레드 설정되며 아래의 작업을 처리함

1. I/O 작업 (예: 파일 읽기/쓰기, 네트워크 요청)
2. 타이머 관리 (setTimeout, setInterval)
3. DNS 조회
4. Crypto 연산 (예: 암호화, 해시 계산)
